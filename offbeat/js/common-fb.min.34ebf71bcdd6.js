




/*
     FILE ARCHIVED ON 9:45:31 Jun 6, 2015 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 10:19:16 Dec 17, 2015.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
function getFormattedName(e){var t=e.split(",")[0];return t.length<=16?t:t.substring(0,13)+"..."}function getCustomFormattedName(e,t){var n=e.split(",")[0];return n.length<=t?n:n.substring(0,t-3)+"..."}function capitaliseFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function getImageUrl(e,t){var n=e.api_name;if(t=="mini-thumbnail")return n=="500px"?e.image_url.split("3.jpg")[0]+"1.jpg":e.image_url.split("_n.jpg")[0]+"_s.jpg";if(t=="small-thumbnail")return n=="500px"?e.image_url.split("3.jpg")[0]+"2.jpg":e.image_url.split("_n.jpg")[0]+"_q.jpg";if(t=="medium-thumbnail")return e.image_url;if(t=="large-thumbnail")return n=="500px"?e.image_url.split("3.jpg")[0]+"4.jpg":e.image_url.split("_n.jpg")[0]+".jpg";if(t=="xlarge")return n=="500px"?e.image_url.split("3.jpg")[0]+"5.jpg":e.image_url.split("_n.jpg")[0]+".jpg"}function getMonth(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December"}}function getDay(e){switch(e){case 6:return"Sun";case 5:return"Mon";case 4:return"Tue";case 3:return"Wed";case 2:return"Thu";case 1:return"Fri";case 0:return"Sat"}}function addDate(e,t){if(t=="undefined"||t==null)t=0;var n=e.split("-"),r=new Date(n[2],n[1]-1,n[0]);return r.setDate(r.getDate()+t),r.getDate()+"-"+(r.getMonth()+1)+"-"+r.getFullYear()}function isLessThanDate(e,t){var n=e.split("-"),r=new Date(n[2],n[1]-1,n[0]),i=t.split("-"),s=new Date(i[2],i[1]-1,i[0]);return r.valueOf()<s.valueOf()?!0:!1}function isGreaterThanTime(e,t){var n=e.split(":"),r=parseInt(n[0])*60+parseInt(n[1]),i=t.split(":"),s=parseInt(i[0])*60+parseInt(i[1]);return r>s?!0:!1}function ddmmyyyyToDate(e){if(e==null||e=="")return null;var t=e.split("-"),n=new Date(t[2],t[1]-1,t[0]);return n}function splitPoint(e){e=e.toString();var t="";if(e.indexOf(".")){var n=e.split(".");if(n[1])var r=n[0]+"h "+n[1]+"m";else var r=n[0]+"h "+"0m";t+=r}else t+=e+" h";return t}function getWeatherIcon(e){var t=e.toLowerCase();return t.indexOf("flurries")>-1?"icon-flurries":t.indexOf("freezing")>-1&&t.indexOf("rain")>-1?"icon-sleet":t.indexOf("rain")>-1?"icon-rain":t.indexOf("sleet")>-1?"icon-sleet":t.indexOf("snow")>-1?"icon-snow":t.indexOf("thunderstorms")>-1?"icon-bigtstorm":t.indexOf("thunderstorm")>-1?"icon-tstorm":t.indexOf("clear")>-1?"icon-clear":t.indexOf("mostly")>-1&&t.indexOf("sunny")>-1?"icon-mostsunny":t.indexOf("partly")>-1&&t.indexOf("sunny")>-1?"icon-partsunny":t.indexOf("sunny")>-1?"icon-sunny":t.indexOf("mostly")>-1&&t.indexOf("cloudy")>-1?"icon-mostcloudy":t.indexOf("partly")>-1&&t.indexOf("cloudy")>-1?"icon-partcloudy":t.indexOf("cloudy")>-1?"icon-cloudy":t.indexOf("fog")>-1?"icon-fog":t.indexOf("haze")>-1?"icon-hazy":t.indexOf("overcast")>-1?"icon-cloudy":t.indexOf("scattered")>-1&&t.indexOf("clouds")>-1?"icon-partcloudy":"icon-na"}function decimalToString(e){var t=Math.floor(e),n=e*60-t*60;return t+"h"+" "+parseInt(n,10)+"m"}function closedOn(e){if(e==127)return"-";var t="",n;for(var r=0;r<7;r++){n=1<<r;var i=e&n;i==0&&(t+=getDay(r)+" ")}return $.trim(t)}function generateWeather(e,t){var n="",r,i;for(var s=0;s<e.length;s++)t=="C"?(r=e[s].max_temp,i=e[s].min_temp):(r=Math.round(e[s].max_temp*9/5+32),i=Math.round(e[s].min_temp*9/5+32)),n+='<li class="point-date tooltip" title=\'<div class="show-tooltip"><p class="inf">'+e[s].condition+'</p></div>\'>							<p class="point-date-title">'+e[s].day_of_week.toUpperCase().substring(0,3)+", "+e[s].day_of_month+" "+e[s].month.substring(0,3)+'</p>							<p class="weather-info">'+r+'<span class="min-temp">/'+i+'</span></p>							<span class="'+getWeatherIcon(e[s].condition)+'"></span>						</li>';return n}function getFirstMatch(e,t){var n=e.toLowerCase(),r=n.split(/[,\/ ]/),i=-1,s=99999;for(var o=0;o<t.length;o++){var u=0,a=t[o].toLowerCase();if(a.indexOf(n)!=-1)u=parseInt((a.indexOf(n)/4).toString(),10);else{var f=-1,l=10;for(var c=0;c<r.length;c++){var h=r[c],p=a.indexOf(h);if(p>f){var d=p-f-1;d>l-5&&(d=l-5),u+=d,f=p}else u+=l,l+=5}}s>u&&(s=u,i=o)}return i}function getWeatherWidget(e,t,n){var r=null;$.get("/weather?name="+e,function(e){var i=JSON.parse(e);r=i.weather;var s;n=="C"?s=generateWeather(r,"C"):s=generateWeather(r,"F"),t.html(s)})}function getQueryToken(e){window.btoa||(window.btoa=base64.encode);var t=window.btoa(unescape(encodeURIComponent(e)));return t.replace("+","-").replace("/","_").replace("=",",")}function getViaText(e){return e=="A"?"GoIbibo":e=="B"?"RedBus":e=="T"?"IRCTC":""}function getTransportName(e){if(e=="A")return"Plane";if(e=="B")return"Bus";if(e=="C")return"Cab";if(e=="F")return"Ferry";if(e=="T")return"Train"}function getTransportClass(e,t){if(t=="dark"){if(e=="A")return"icon-dark-plain";if(e=="B")return"icon-dark-bus";if(e=="C")return"icon-dark-car";if(e=="T")return"icon-dark-train"}else if(t=="gray"){if(e=="A")return"icon-plane-grey";if(e=="B")return"icon-bus-grey";if(e=="C")return"icon-car-grey";if(e=="T")return"icon-train-grey"}else if(t=="vertical"){if(e=="A")return"vertical-plain";if(e=="B")return"vertical-bus";if(e=="C")return"vertical-cab";if(e=="T")return"vertical-train"}}function getDaysCount(e,t){var n=e.getTime(),r=t.getTime();return n==r?1:(r-n)/864e5}function getSTemp(e){var t=Number(e);return t%2==0?(t=Math.floor(t/10),t=2*t):(t=Math.floor(t/10),t=2*t-1),t}function validateEmail(e){if(e==null||e=="")return!1;var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}function validatePhone(e){if(e==null||e=="")return!1;var t=/^\+?\d{2}[- ]?\d{3}[- ]?\d{5}$/;return t.test(e)}function executeCommand(){if(localStorage.getItem("login-type")!=null&&localStorage.getItem("login-type")!=""){if(_cmd=="_modify_")localStorage.setItem("current-trip",localStorage.getItem("_modify_trip")),localStorage.setItem("query-param"
,localStorage.getItem("_modify_query")),localStorage.removeItem("_modify_trip"),localStorage.removeItem("_modify_query"),location.href="/planner-map";else if(_cmd=="_save_")$.post("/save-trip",{data:localStorage.getItem("_save_trip"),trip_mode:localStorage.getItem("_save_trip_mode"),trip_id:localStorage.getItem("_save_trip_id"),trip_type:localStorage.getItem("_save_trip_type")},function(e){localStorage.removeItem("_save_trip"),localStorage.removeItem("_save_trip_mode"),localStorage.removeItem("_save_trip_id"),localStorage.removeItem("_save_trip_type"),e.hasOwnProperty("error")||($("#trip-id").val(e.trip_id),$("#trip-mode").val(e.trip_mode))});else if(_cmd!="_favourite_")if(_cmd=="_share_"){var e=localStorage.getItem("_share_click");e!=null&&e!=""&&(localStorage.removeItem("_share_click"),$(e).trigger("click"))}else if(_cmd=="_open_"){var t=localStorage.getItem("_open_trip_id"),n=localStorage.getItem("_open_trip_mode");localStorage.removeItem("_open_trip_id"),localStorage.removeItem("_open_trip_id"),location.reload(!1)}else if(_cmd=="_friends-signin_"){var r=localStorage.getItem("_latitude"),i=localStorage.getItem("_longitude");r!=null&&i!==null&&$.get("/friends?latitude="+r+"&longitude="+i,function(e){e=JSON.parse(e);if(!e.hasOwnProperty("error")&&e.hasOwnProperty("data")&&e.data.length>0){$(".point-visit-friends").html("<h3>Friends been here</h3>");var t=e.data,n='<div class="friends-strip-holder">';for(var r=0;r<t.length&&r<6;r++){var i='title=\'<div class="show-tooltip"><p class="inf">'+t[r].name+"</p></div>'";n+='<img name="'+t[r].name+'" src="'+t[r].pic_square+'" '+i+">"}t.length>6&&(n+="+"+(t.length-6)+" more"),n+="</div>",$(".point-visit-friends").append(n),$(".friends-strip-holder img").tooltipster()}else $(".point-visit-friends").empty()}),localStorage.removeItem("_latitude"),localStorage.removeItem("_longitude")}$.get("/my-favourite",function(e){var t=JSON.parse(e);t.hasOwnProperty("error")||(_favourite=t.favourite)})}else _favourite=[];_cmd=""}function formatTooltipTime(e){if(e==null)return"";var t=e.split(":");return str="",t[0].length==1?str+="0"+t[0]:str+=t[0],str+=".",t[1].length==1?str+="0"+t[1]:str+=t[1],str}function removePhotos(e){if(e!=null)for(var t=1;t<e.length-1;t++){e[t].hasOwnProperty("photos")&&delete e[t].photos;if(e[t].hasOwnProperty("activities"))for(var n=0;n<e[t].activities.length;n++)e[t].activities[n].hasOwnProperty("photos")&&delete e[t].activities[n].photos}}function initializeMap(){var e,t=[{featureType:"water",stylers:[{saturation:43},{lightness:-11},{hue:"#0088ff"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{hue:"#ff0000"},{saturation:-100},{lightness:99}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#808080"},{lightness:54}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#ece2d9"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#ccdca1"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#767676"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#b8cb93"}]},{featureType:"poi.park",stylers:[{visibility:"on"}]},{featureType:"poi.sports_complex",stylers:[{visibility:"on"}]},{featureType:"poi.medical",stylers:[{visibility:"on"}]},{featureType:"poi.business",stylers:[{visibility:"simplified"}]}],n={streetViewControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_TOP},zoom:4,center:new google.maps.LatLng(17.915,77.519),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:t};return e=new google.maps.Map(document.getElementById("map-canvas"),n),e}function addArrows(){$(".full-trip-holder").each(function(){$(this).find(".next").hide(),$(this).children(".start-point").offset().top<$(this).children(".end-point").offset().top?$(this).height()>200?($(this).find(".next").css("bottom","35px"),$(this).find(".next-line").show(),$(this).find(".next").show()):($(this).find(".next-line").show(),$(this).find(".next").show(),$(this).find(".next").css("bottom","3px")):($(this).children(".next-line").hide(),$(this).children(".next").hide())});var e=$("body").width(),t=Math.floor((e-210)/90)-1;$(".images-strip-holder").each(function(){var e=0,n=$(this).children(".search-place-image-holder");n.each(function(){e<t?$(this).show():$(this).hide(),e++})})}function showCredits(e){var t=null;$(e).find(".copyRightCameraImg").hover(function(){t&&clearTimeout(t),t=setTimeout(function(){$(".ResultsCopyrightContainer").css("background","rgba(0,0,0,0.7)"),$(e).find(".ResultsImgAuthorName").show(500)},100)},function(){t&&clearTimeout(t),$(e).find(".ResultsImgAuthorName").hide(500),$(".ResultsCopyrightContainer").css("background","none")})}function getTransportFairTypeName(e){if(e=="A")return"Air Fare";if(e=="B")return"Bus Fare";if(e=="C")return"Cab Fare";if(e=="F")return"Ferry Fare";if(e=="T")return"Train Fare"}function buildUrl(e,t){var n="";for(var r in t){var i=t[r];if(!i)continue;i=i.toString().split('"').join('"'),n+=r+"="+encodeURIComponent(i)+"&"}return n.length>0&&(n=n.substring(0,n.length-1),e=e+"?"+n),e}function getAmenityClass(e){e=e.toLowerCase();switch(e){case"air conditioned":return"ac";case"restaurant":return"resto";case"bar":return"cocktail";case"room service":return"meal";case"wi-fi":return"wifi";case"internet":return"internet";case"24Hours":return"daynight";case"business center":return"business";case"gym":return"gym";case"coffee shop":return"cofee";case"pool":return"pool";default:return"ac"}}function isFavourite(e){_favourite||(_favourite=JSON.parse(localStorage.getItem("_favourite")));if(_favourite)for(var t=0;t<_favourite.length;t++){var n=_favourite[t];if(n.id==e)return!0}return!1}function callInitMethods(){var e=localStorage.getItem("login-type");e?$.get("/my-favourite",function(e){var t=JSON.parse(e);t.hasOwnProperty
("error")?_favourite=[]:(_favourite=t.favourite,localStorage.setItem("_favourite",JSON.stringify(_favourite)))}):_favourite=[]}function getCookie(e){var t=null;if(document.cookie&&document.cookie!=""){var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=jQuery.trim(n[r]);if(i.substring(0,e.length+1)==e+"="){t=decodeURIComponent(i.substring(e.length+1));break}}}return t}function csrfSafeMethod(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function toTitleCase(e){return e.replace(/(?:^|\s)\w/g,function(e){return e.toUpperCase()})}function enableCSRFProtection(){var e=getCookie("csrftoken");$.ajaxSetup({beforeSend:function(t,n){!csrfSafeMethod(n.type)&&!this.crossDomain&&t.setRequestHeader("X-CSRFToken",e)}}),callInitMethods()}function getDestinationScore(e,t){var n=[];for(var r in e)e[r].length==1?n.push([r,e[r][0]]):n.push([r,e[r][t]]);return n.sort(function(e,t){return e[1]>t[1]?-1:e[1]<t[1]?1:0}),n}function numberWithComma(e){return e.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")}function getTimestampString(e){var t,n=new Date,r=parseInt((n.getTime()-e)/36e5,10);if(r<=24)return r==1?"1 hour ago":r==0?(r=parseInt((n.getTime()-e)/6e4,10),r==0?(r=parseInt((n.getTime()-e)/1e3,10),r==1?r+" second ago":r+" seconds ago"):r==1?r+" minute ago":r+" minutes ago"):r+" hours ago";if(r<48){var i=new Date(e);t=i.toTimeString(),s=t.split(":");var o=parseInt(s[0]);return o>12?"Yesterday at "+(o-12)+":"+s[1]+" pm":o==12?"Yesterday at "+o+":"+s[1]+" pm":"Yesterday at "+o+":"+s[1]+" am"}if(r<720){var i=parseInt(r/24,10);return i+" days ago"}var i=new Date(e);return t=i.getDate()+" "+getMonth(i.getMonth()).substring(0,3),t}function trunc(e,t,n){var r=e.length>t,i=r?e.substr(0,t-1):e;return i=n&&r?i.substr(0,i.lastIndexOf(" ")):i,r?i+"&hellip;":i}function getScoreColorValue(e){return e=="pos"?"rgb(37, 154, 0)":e=="neu"?"rgb(249, 194, 0)":"rgb(241, 116, 84)"}function getTrustScore(e){if(!(e.api_params&&e.api_params.trust_you&&e.api_params.trust_you.summary))return"";var t=e.api_params.trust_you.summary,n=trustScoreColor(t.score);return'<div class="trust-score "> <div class="score trust'+n+'big">'+t.score+'</div><span class="desc"> '+t.score_description+" </span></div>"}function trustScoreColor(e){return e>=70?"green":e>=50?"yellow":"orange"}function getTime12Hour(e){if(e==null)return null;var t=e.split(":");if(t.length<2)return null;var n;return parseInt(t[0])>12?n=parseInt(t[0])-12+":"+t[1]+" PM":parseInt(t[0])==12?n=t[0]+":"+t[1]+" PM":parseInt(t[0])==0?n="12:"+t[1]+" AM":n=t[0]+":"+t[1]+" AM",n}function getCabBookingSource(){return"ClearCarRental"}function tConvert(e){var t=e.split(":");return t[1]==0&&(t[1]="00"),e=t[0]+":"+t[1],e=e.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[e],e.length>1&&(e=e.slice(1),e[5]=+e[0]<12?" AM":" PM",e[0]=+e[0]%12||12),e.join("")}function getCabUrl(e,t,n,r,i){t.length==1?url="//clearcarrental.com/vehicle-search?travelTypeOption=1&tripTypeOption=1&sourceCity="+e:url="//clearcarrental.com/vehicle-search?travelTypeOption=1&tripTypeOption=3&sourceCity="+e;for(var s=0;s<t.length;s++)url+="&destinationCity="+t[s];var o=n.split("-"),u=o[0]+"-"+getMonth(parseInt(o[1])-1)+"-"+o[2];return url+="&travelDate="+u+"&days="+r,url+="&pTime="+getTime12Hour(i)+"&trackId=CCRTIG",url}function heatMap(e,t){var n=[];for(var r=0;r<t.length;r++){var i=new google.maps.LatLng(t[r].latitude,t[r].longitude);n.push(i)}var s=new google.maps.MVCArray(n);heatmap=new google.maps.visualization.HeatmapLayer({data:s}),heatmap.set("radius",30);var o=["rgba(0, 0, 0, 1)","rgba(0, 255, 255, 1)","rgba(0, 255, 255, 1)","rgba(0, 191, 255, 1)","rgba(0, 127, 255, 1)","rgba(0, 63, 255, 1)","rgba(0, 0, 255, 1)","rgba(0, 0, 223, 1)","rgba(0, 0, 191, 1)","rgba(0, 0, 159, 1)","rgba(0, 0, 127, 1)","rgba(63, 0, 91, 1)","rgba(127, 0, 63, 1)","rgba(191, 0, 31, 1)","rgba(255, 0, 0, 1)"];return heatmap.set("gradient",heatmap.get("gradient")?o:o),heatmap.setMap(e),e.getZoom()<=10&&e.setZoom(e.getZoom()+1),heatmap}function httptoHttps(e){return e==null?e:e.replace("http://","https://")}function starRating(e){var t;switch(e){case"1":t='<img src="../static/css/images/1star.png"/><span class="star-count">1 star hotel</span>';break;case"2":t='<img src="../static/css/images/2star.png"/><span class="star-count">2 star hotel</span>';break;case"3":t='<img src="../static/css/images/3star.png"/><span class="star-count">3 star hotel</span>';break;case"4":t='<img src="../static/css/images/4star.png"/><span class="star-count">4 star hotel</span>';break;case"5":t='<img src="../static/css/images/5star.png"/><span class="star-count">5 star hotel</span>';break;default:t='<img/><span class="star-count">'+e+"</span>"}return t}function getRoomTypeText(e,t){var n="",r;e.price["single"]!=-1?(r=t*e.price.single,r="Rs "+r):r="N/A";var i="";return i+='<div class="room-variant">',n?i+='<input type="radio" name="rooms" selected value="room1">':i+='<input type="radio" name="rooms" value="room1">',i+='<p class="room-type">'+e.room_type+"</p>",i+='<p class="room-price">'+r+"</p>",i+="</div>",i}function timeFormet(e){var t=e.split(":"),n=t[0]+"h "+t[1]+"m";return n}var _cmd,_favourite,mostlyVisible=function(e){var t=$(window).scrollTop(),n=$(window).height(),r=$(e).offset().top,i=$(e).height(),s=r+i;return s-i*.25>t&&r<t+.5*n},seo_modifier=function(e,t){t&&scrollTempUrl!=e.attr("data-url")&&(scrollTempUrl=e.attr("data-url"),history.replaceState(null,null,e.attr("data-url")));var n=document.domain,r=e.attr("data-cannonical");global_cannonical=r,e.attr("data-index")=="true"?($("meta[name='robots']").attr("content","index, follow"),$("link[rel=canonical]").attr("href",r)):($("link[rel=canonical]").attr("href",global_cannonical),$("meta[name='robots']").attr("content","noindex, follow")),$("title").text(e.attr("data-title")),$("meta[name='description']").attr("content",e.attr("data-desc"));if(e.attr("data-prev")!="false"){if($("link[rel=prev]")[0])var i=$("link[rel=prev]")[0];else{var i=document.createElement("link");$(i).attr("rel"
,"prev").insertAfter($("link[rel=canonical]"))}$(i).attr("href",document.location.protocol+"//"+document.location.host+e.attr("data-prev"))}e.attr("data-prev")=="false"&&$("link[rel='prev']").remove();if(e.attr("data-next")!="false"){if($("link[rel=next]")[0])var s=$("link[rel=next]")[0];else{var s=document.createElement("link");$(s).attr("rel","next").insertAfter($("link[rel=canonical]"))}$(s).attr("href",document.location.protocol+"//"+document.location.host+e.attr("data-next"))}e.attr("data-next")=="false"&&$("link[rel='next']").remove()},convertDate=function(e){if(e==null)return"";var t=e.split("-"),n=t[1];switch(n){case"1":var r="Jan,";break;case"2":var r="Feb,";break;case"3":var r="Mar,";break;case"4":var r="Apr,";break;case"5":var r="May,";break;case"6":var r="Jun,";break;case"7":var r="Jul,";break;case"8":var r="Aug,";break;case"9":var r="Sept,";break;case"10":var r="Oct,";break;case"11":var r="Nov,";break;case"12":var r="Dec,"}return t[0]+" "+r+" "+t[2]},mom_Date=function(e){if(e){var t=new Date;t.setDate(t.getDate()+e)}else var t=new Date;var n=String.prototype.split.call(t," "),r=n[2].slice(-1);switch(r){case"1":return n[1]+" "+n[2]+"st "+n[3].slice(-2);case"2":return n[1]+" "+n[2]+"nd "+n[3].slice(-2);case"3":return n[1]+" "+n[2]+"rd "+n[3].slice(-2);default:return n[1]+" "+n[2]+"th "+n[3].slice(-2)}};$(document).ready(function(){function u(){$(".profile-login").unbind("click").bind("click",function(){$(".overlay").fadeIn(function(){$("#sign-modal").fadeIn()})}),$("body").unbind("click").bind("click",function(e){$(e.target).closest("#sign-modal").length==0&&$(e.target).closest("#recovery-modal").length==0&&($("#sign-modal").is(":visible")||$("#recovery-modal").is(":visible"))&&f(),$(e.target).closest(".dropdown-notification").length==0&&$(".dropdown-notification").is(":visible")&&$(".dropdown-notification").fadeOut("fast"),$(e.target).closest(".dropdown-profile").length==0&&$(".dropdown-profile").is(":visible")&&$(".dropdown-profile").fadeOut("fast")}),$(document).keyup(function(e){e.keyCode==27&&($("#sign-modal").is(":visible")||$("#recovery-modal").is(":visible"))&&f()}),$(".remeber-user").unbind("click").bind("click",function(e){$(this).toggleClass("remeber-selected")}),$(".close-login").unbind("click").bind("click",function(){$(this).parent().fadeOut("fast",function(){$(".overlay-load-save").fadeOut(),$(".overlay").fadeOut("fast"),$(".error-message").empty(),$(".error-message").hide(),$("#sign-modal input").val(""),$("#recovery-modal input").val(""),executeCommand()}),$(".welcome-video").find("video").length>0&&$(".welcome-video").find("video")[0].pause()}),$(".login-tab").unbind("click").bind("click",function(){$(".tab-selector .sign-tab").removeClass("tab-selected"),$(this).addClass("tab-selected"),$("#sign-modal .sign-tab-container").hide(),$("#login-tab").show()}),$(".signup-tab").unbind("click").bind("click",function(e){$(".tab-selector .sign-tab").removeClass("tab-selected"),$(this).addClass("tab-selected"),$("#sign-modal .sign-tab-container").hide(),$("#signup-tab").show()}),$(".forget-password").unbind("click").bind("click",function(e){$("#sign-modal").hide(),$("#recovery-modal").show()}),$(".action-recover").unbind("click").bind("click",function(){var e=$(this).parent().children(".email-name").val();if(!validateEmail(e))$(this).parent().children(".email-name").css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"}),$(this).focus()});else{var t={email:e};$.post("/password-recover",t,function(e){}),$("#recovery-tab").hide(),$("#recovery-tab-done").show()}}),$(".facebook-signup").unbind("click").bind("click",function(e){$(".overlay-load-save").fadeIn(),FB.login(function(){},{scope:"public_profile,email,user_friends",return_scopes:!0});var t=$(this).parent().parent().attr("id");t=t.replace("-tab",""),ga("send","event","login_signup","fb_"+t)});var n={apppackagename:"com.worthyourholidays.tripigator",callback:a};$(".gplus-signup").unbind("click").bind("click",function(){$(".overlay-load-save").fadeIn(),gapi.auth.signIn(n);var e=$(this).parent().parent().attr("id");e=e.replace("-tab",""),ga("send","event","login_signup","gplus_"+e)}),$("#sign-modal input").focusin(function(){$(this).css({borderWidth:"2px"})}),$("#sign-modal input").focusout(function(){$(this).css({borderWidth:"1px"})}),$("#recovery-modal input").focusin(function(){$(this).css({borderWidth:"2px"})}),$("#recovery-modal input").focusout(function(){$(this).css({borderWidth:"1px"})}),$(".login-form .action-login").unbind("click").bind("click",function(){var e=$(this).parent().children(".email-name").val();ga("send","event","login_signup","manual_login");if(!validateEmail(e))$(this).parent().children(".email-name").css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"}),$(this).focus()});else{var t=$(this).parent().children(".password").val();if(t==null||t=="")$(this).parent().children(".password").css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"}),$(this).focus()});else{var n={username:e,password:t,login_type:"manual",sign_up:"false"};$(".overlay-load-save").fadeIn(),$.post("/signup",n,function(e){result=JSON.parse(e),result.hasOwnProperty("error")?($(".login-form .error-message").html(result.message),$(".password").val(""),$(".login-form .error-message").show()):(localStorage.setItem("login-type","manual"),l(result.data,result.trips_count),$("#sign-modal").fadeOut("fast",function(){f()}))})}}return!1}),$("#recovery-modal .action-login").unbind("click").bind("click",function(){$("#recovery-modal").hide(),$("#sign-modal").show()}),$(".signup-form .action-signup").unbind("click").bind("click",function(){var e=$(this).parent().children(".signup-name").val(),t=$(this).parent().children(".email-name").val(),n=$(this).parent().children(".password").eq(0).val(),r=$(this).parent().children(".password").eq(1).val();ga("send","event","login_signup"
,"manual_signup");if(e==null||e=="")$(this).parent().children(".signup-name").css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"}),$(this).focus()});else if(!validateEmail(t))$(this).parent().children(".email-name").css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"}),$(this).focus()});else if(n==null||n==""||r==null||r==""||n!=r)$(this).parent().children(".password").eq(0).css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"}),$(this).focus()}),$(this).parent().children(".password").eq(1).css("border","2px solid red").animate({borderWidth:"2px"},1e3,function(){$(this).css({border:"1px solid #cccccc"})});else{var i={name:e,username:t,email:t,password:n,login_type:"manual",sign_up:"true"};$(".overlay-load-save").fadeIn(),$.post("/signup",i,function(e){var t=JSON.parse(e);t.hasOwnProperty("error")?($(".signup-form .error-message").html(t.message),$(".password").val(""),$(".signup-form .error-message").show()):(localStorage.setItem("login-type","manual"),l(i,e.trips_count),f())})}return!1}),$(".logout").unbind("click").bind("click",function(){var n=localStorage.getItem("login-type");$.post("/logout",function(){n=="google+"?(gapi.auth.signOut(),e=!1):n=="facebook"&&localStorage.getItem("fb_signin")!=null&&localStorage.getItem("fb_signin")=="true"&&(localStorage.removeItem("fb_signin"),FB.logout()),clearTimeout(t),localStorage.removeItem("login-type"),$("#profile").html('<div class="profile-login">							<a>Login</a>						</div>'),_favourite=[],u()})}),$(".notification-holder").unbind("click").bind("click",function(){$(".dropdown-notification").is(":visible")?$(".dropdown-notification").fadeOut("fast"):$.get("/my-notifications",function(e){var t=JSON.parse(e);if(!t.hasOwnProperty("error")){var n=t.notification_count,r="";if(n==0)r+="<li><p>0 notifications found</p></li>",$(".dropdown-notification .general-holder ul").html(r);else{for(var i=0;i<n;i++){var s=t.notifications[i];s.notification_type<=3&&(r+='<li name="'+s.notification_action+'">									<p class="notif-message" url="'+s.notification_url+'" name="'+s.notification_id+'">'+s.notification_message+'</p>									<p class="notif-timestamp">'+getTimestampString(s.notification_timestamp)+"</p>									</li>")}$(".dropdown-notification .general-holder ul").html(r)}$(".dropdown-notification .general-holder ul li").css({"background-color":"#fff"}),$(".dropdown-notification .general-holder ul li[name='N']").css({"background-color":"#f5f5f5"}),$(".dropdown-notification .general-holder ul li").hover(function(){$(this).css({"background-color":"#f8f8f8"})},function(){$(this).attr("name")=="N"?$(this).css({"background-color":"#f5f5f5"}):$(this).css({"background-color":"#fff"})})}$(".dropdown-profile").fadeOut("fast",function(){$(".dropdown-notification").fadeIn("fast")})})}),$(".dropdown-notification .general-holder ul").on("click","li",function(){var e={notification_id:$(this).children("p").attr("name")},t=$(this).children("p").attr("url");$.post("/mark-notification",e,function(e){var n=JSON.parse(e);location.href=t})}),$(".username-holder").unbind("click").bind("click",function(e){$(".dropdown-profile").is(":visible")?$(".dropdown-profile").fadeOut("fast"):$(".dropdown-notification").is(":visible")?$(".dropdown-notification").fadeOut("fast",function(){$(".dropdown-profile").fadeIn("fast")}):$(".dropdown-profile").fadeIn("fast"),e.stopPropagation()})}function a(t){t.status.signed_in?(e==0&&(e=!0,localStorage.setItem("login-type","google+"),gapi.client.load("plus","v1",function(){var e=gapi.client.plus.people.get({userId:"me"});e.execute(function(e){var n;for(var r=0;r<e.emails.length;r++){email=e.emails[r].value;if(e.emails[r].type=="account"){n=e.emails[r].value;break}}var i=e.image.url,s={name:e.displayName,username:n,location:e.currentLocation,id:e.id,access_token:t.access_token,email:email,birthday:e.birthday,gender:e.gender,image_url:i,login_type:"google+"};$.post("/signup",s,function(e){$(".overlay-load-save").fadeOut();var t=JSON.parse(e),n=0;t.hasOwnProperty("error")||(n=t.trips_count);var r='<div class="notification-holder">						<span class="notice notice-gray"></span>						<a class="notification"></a>					</div>					<div class="dropdown-notification"> 						<div class="arrow"></div> 						<div class="general-holder"> 							<div class="notif-header">Notifications</div> 							<ul> 								<li class="account"><a href="/account#profile"></a></li> 							</ul> 						</div> 					</div> 					<div class="username-holder">						<span class="account-gray"></span>						<a class="username">'+s.name+'</a>					</div>					<div class="dropdown-profile">						<div class="arrow"></div>						<div class="general-holder">							<img class="user-avatar" src="'+i+'">							<div class="general-information">								<h3 class="username">'+s.name+'</h3>								<p><span class="trip-count">'+n+'</span> trips</p>								<!--p><span class="place-count">12</span> places traveled</p-->							</div>							<ul>								<li class="account"><a href="/account#profile"></a></li>								<li class="favourite"><a href="/account#wishlist"></a></li>								<li class="bag"><a href="/account#trips"></a></li>								<li class="share"><a href="/account#shared"></a></li>								<li class="settings"><a href="/account#settings"></a></li>							</ul>							<div class="account-logout"><a class="logout blue">Logout</a></div>						</div>					</div>';$("#profile").html(r),u(),$("#sign-modal").fadeOut("fast",function(){$(".overlay").fadeOut("fast"),$(".error-message").empty(),$(".error-message").hide(),executeCommand()})})})})),$(".overlay-load-save").fadeOut()):(console.log("Sign-in state: "+t.error),$(".overlay-load-save").fadeOut())}function f(){$(".overlay").fadeOut("fast",function(){$("#sign-modal").fadeOut("fast"),$("#recovery-modal").fadeOut("fast"),$(".error-message").empty(),$(".error-message").hide(),$
("#sign-modal input").val(""),$("#recovery-modal input").val(""),$(".overlay-load-save").fadeOut()}),executeCommand()}function l(e,t){var n='<div class="notification-holder">						<span class="notice notice-gray"></span>						<a class="notification"></a>					</div>					<div class="dropdown-notification"> 						<div class="arrow"></div> 						<div class="general-holder"> 							<div class="notif-header">Notifications</div> 							<ul> 								<li class="account"><a href="/account#profile"></a></li> 							</ul> 						</div> 					</div> 					<div class="username-holder">						<span class="account-gray"></span>						<a class="username">'+e.name+'</a>					</div>					<div class="dropdown-profile">						<div class="arrow"></div>						<div class="general-holder">							<img class="user-avatar" src="">							<div class="general-information">								<h3 class="username">'+e.name+'</h3>								<p><span class="trip-count">'+t+'</span> trips</p>								<!--p><span class="place-count">12</span> places traveled</p-->							</div>							<ul>								<li class="account"><a href="/account#profile"></a></li>								<li class="favourite"><a href="/account#wishlist"></a></li>								<li class="bag"><a href="/account#trips"></a></li>								<li class="share"><a href="/account#shared"></a></li>								<li class="settings"><a href="/account#settings"></a></li>							</ul>							<div class="account-logout"><a class="logout blue">Logout</a></div>						</div>					</div>';$("#profile").html(n),u()}function c(){var e=localStorage.getItem("login-type");if(e==null||e==""){var t='<div class="profile-login">							<a>Login</a>						</div>';$("#profile").html(t)}else $.get("/status-check",function(e){var t=JSON.parse(e);if(t.success=="true"){var n='<div class="notification-holder">						<span class="notice notice-gray"></span>						<a class="notification"></a>					</div>					<div class="dropdown-notification"> 						<div class="arrow"></div> 						<div class="general-holder"> 							<div class="notif-header">Notifications</div> 							<ul> 								<li class="account"><a href="/account#profile"></a></li> 							</ul> 						</div> 					</div> 					<div class="username-holder">						<span class="account-gray"></span>						<a class="username">'+t.name+'</a>					</div>					<div class="dropdown-profile">						<div class="arrow"></div>						<div class="general-holder">							<img class="user-avatar" src="'+t.image_url+'">							<div class="general-information">								<h3 class="username">'+t.name+'</h3>								<p><span class="trip-count">'+t.trips_count+'</span> trips</p>								<!--p><span class="place-count">12</span> places traveled</p-->							</div>							<ul>								<li class="account"><a href="/account#profile"></a></li>								<li class="favourite"><a href="/account#wishlist"></a></li>								<li class="bag"><a href="/account#trips"></a></li>								<li class="share"><a href="/account#shared"></a></li>								<li class="settings"><a href="/account#settings"></a></li>							</ul>							<div class="account-logout"><a class="logout blue">Logout</a></div>						</div>					</div>';$("#profile").html(n),$("body").trigger("startinvitefriends"),u()}else{localStorage.removeItem("login-type");var r='<div class="profile-login">							<a>Login</a>						</div>';$("#profile").html(r)}})}function h(){var e=setTimeout(function(){var e=localStorage.getItem("login-type");e!=null?$.get("/new-notifications",function(e){var t=JSON.parse(e);t.hasOwnProperty("error")||(t["notification_count"]==0?($(".notice").addClass("notice-gray"),$(".notification").text("")):($(".notice").removeClass("notice-gray"),$(".notification").text(t.notification_count))),h()}):h()},6e4)}var e=!1;c();var t,n,r="",i,s=0,o=!1;window.fbAsyncInit=function(){var e=!1;localStorage.getItem("login-type")=="facebook"&&(e=!0),FB.init({appId:window.location.hostname==="54.254.240.249"?"142448795963729":"264649413697146",channelUrl:"/",status:e,cookie:!0,xfbml:!0,version:"v2.1"}),FB.Event.subscribe("auth.authResponseChange",function(e){e.status==="connected"?e.authResponse.grantedScopes&&e.authResponse.grantedScopes.indexOf("email")>=0?(o=!1,n=e.authResponse.accessToken,i=e.authResponse.expiresIn*1e3,localStorage.setItem("login-type","facebook"),FB.api("/me",function(e){r+="<table><tr><th>Property</th><th>Value</th></tr>",r+="<tr><td>First Name = </td><td>"+e.first_name+"</td></tr>",r+="<tr><td>Last Name = </td><td>"+e.last_name+"</td></tr>",r+="<tr><td>Profile Link =</td><td> "+e.link+"</td></tr>",r+="<tr><td>User Name = </td><td> "+e.username+"</td></tr>",r+="<tr><td>Hometown = </td><td> "+(e.hometown&&e.hometown.name?e.hometown.name:"")+"</td></tr>",r+="<tr><td>Email = </td><td> "+e.email+"</td></tr>",r+="<tr><td>Location = </td><td> "+(e.location&&e.location.name?e.location.name:"")+"</td></tr></table>",r+="<hr color='black' width='100%'>";var t={name:e.name,first_name:e.first_name,location:e.location&&e.location.name?e.location.name:"",id:e.id,access_token:n,email:e.email,birthday:e.birthday,gender:e.gender,image_url:"/web/20150606094531/https://graph.facebook.com/"+e.id+"/picture",login_type:"facebook"};$.post("/signup",t,function(t){$(".overlay-load-save").fadeOut();var n=JSON.parse(t),r=0;n.hasOwnProperty("error")||(r=n.trips_count);var i='<div class="notification-holder">							<span class="notice notice-gray"></span>							<a class="notification"></a>						</div>							<div class="dropdown-notification"> 							<div class="arrow"></div> 							<div class="general-holder"> 								<div class="notif-header">Notifications</div> 								<ul> 									<li class="account"><a href="/account#profile"></a></li> 								</ul> 							</div> 						</div> 						<div class="username-holder">							<span class="account-gray"></span>							<a class="username">'+e.name+'</a>						</div>							<div class="dropdown-profile">							<div class="arrow"></div>							<div class="general-holder">								<img class="user-avatar" src="'+"/web/20150606094531/https://graph.facebook.com/"+e.id+"/picture"+'">								<div class="general-information">									<h3 class="username">'+
e.name+'</h3>									<p><span class="trip-count">'+r+'</span> trips</p>									<!--p><span class="place-count">12</span> places traveled</p-->								</div>								<ul>									<li class="account"><a href="/account#profile"></a></li>									<li class="favourite"><a href="/account#wishlist"></a></li>									<li class="bag"><a href="/account#trips"></a></li>									<li class="share"><a href="/account#shared"></a></li>									<li class="settings"><a href="/account#settings"></a></li>								</ul>								<div class="account-logout"><a href="javascript:void(0)" class="invite-friends">Invite Friends</a><a class="logout blue">Logout</a></div>							</div>								</div>';$("#profile").html(i),$("body").trigger("startinvitefriends"),u(),$("#sign-modal").is(":visible")?$("#sign-modal").fadeOut("fast",function(){$(".overlay").fadeOut("fast"),$(".error-message").empty(),$(".error-message").hide(),executeCommand()}):executeCommand()})}),t=setTimeout(function(){FB.getLoginStatus(function(){},!0)},i)):e.authResponse.grantedScopes&&!o?(o=!0,FB.login(function(){},{scope:"email",auth_type:"rerequest",return_scopes:!0})):e.authResponse.grantedScopes?(o=!1,alert("Could not sign up. Need email permission")):(i=e.authResponse.expiresIn*1e3,t=setTimeout(function(){FB.getLoginStatus(function(){},!0)},i)):e.status==="not_authorized"?($(".overlay-load-save").fadeOut(),FB.login()):(alert("unknown"),FB.login(function(e){e&&e.status=="connected"&&localStorage.setItem("fb_signin","true")}),$(".overlay-load-save").fadeOut())})},function(e){var t,n="facebook-jssdk",r=e.getElementsByTagName("script")[0];if(e.getElementById(n))return;t=e.createElement("script"),t.id=n,t.async=!0,t.src="//connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(t,r),u()}(document),$(".help_wyh_holder").hover(function(){$("div.help_wyh").css({background:"url('static/css/images/help_hover.png')","background-size":"25px 25px"}),$("p.help_wyh").css({color:"#cc6633"})},function(){$("div.help_wyh").css({background:"url('static/css/images/help.png')","background-size":"25px 25px"}),$("p.help_wyh").css({color:"#333"})}),function(e){var t=e.createElement("script");t.type="text/javascript",t.async=!0,t.src="/web/20150606094531/https://apis.google.com/js/client:plusone.js";var n=e.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),u()}(document),h(),$("body").on("startinvitefriends",function(){$(".invite-friends").fSelector({max:null,excludeIds:[],getStoredFriends:[],closeOverlayClick:!0,enableEscapeButton:!0,overlayOpacity:"0.3",overlayColor:"#000",closeOnSubmit:!0,showSelectedCount:!0,showButtonSelectAll:!0,color:"default",lang:{title:"Friend Selector",buttonSubmit:"Send",buttonCancel:"Cancel",buttonSelectAll:"Select All",buttonDeselectAll:"Deselect All",buttonShowSelected:"Show Selected",buttonShowAll:"Show All",summaryBoxResult:"{1} best results for {0}",summaryBoxNoResult:"No results for {0}",searchText:"Enter a friend's name",fbConnectError:"You must connect to Facebook to see this.",selectedCountResult:"You have choosen {0} people.",selectedLimitResult:"Limit is {0} people.",facebookInviteMessage:"Invite message"},maxFriendsCount:null,showRandom:!1,facebookInvite:!0,onStart:function(e){return null},onClose:function(e){return null},onSubmit:function(e){}})})}),function(e,t,n,r){"use strict";var i={},s=!1,o=!1,u=0,a=0,f=1,l="",c,h,p,d="/web/20150606094531/http://developers.facebook.com/docs/reference/javascript/",v=function(){if(FB===r)return alert("Facebook integration is not defined. View "+d),!1;i=n.extend(!0,{},P,i),i.max>0&&i.max!==null&&(i.showSelectedCount=!0,i.showButtonSelectAll=!1),y(),i.onStart()},m=function(){h.fadeOut(400,function(){c.empty(),h.remove(),T(),p.fadeOut(400,function(){p.remove()})}),s=!1,o=!1,i.onClose()},g=function(){var e=[];n("input.fs-friends:checked").each(function(){e.push(parseInt(n(this).val().split("-")[1],10))});if(i.facebookInvite===!0){var t=e.join();FB.ui({method:"apprequests",message:i.lang.facebookInviteMessage,to:t},function(t){t!==null&&(i.onSubmit(e),i.closeOnSubmit===!0&&m())})}else i.onSubmit(e),i.closeOnSubmit===!0&&m()},y=function(){if(s===!0)return;s=!0,n("body").append(p=n('<div id="fs-overlay"></div>'),h=n('<div id="fs-dialog-box-wrap"></div>')),h.append('<div class="fs-dialog-box-bg" id="fs-dialog-box-bg-n"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-ne"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-e"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-se"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-s"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-sw"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-w"></div><div class="fs-dialog-box-bg" id="fs-dialog-box-bg-nw"></div>'),h.append(c=n('<div id="fs-dialog-box-content"></div>'));var t='<div id="fs-dialog" class="fs-color-'+i.color+'">'+'<h2 id="fs-dialog-title"><span>'+i.lang.title+"</span></h2>"+'<div id="fs-filter-box">'+'<div id="fs-input-wrap">'+'<input type="text" id="fs-input-text" title="'+i.lang.searchText+'" />'+'<a href="javascript:{}" id="fs-reset">Reset</a>'+"</div>"+"</div>"+'<div id="fs-user-list">'+"<ul></ul>"+"</div>"+'<div id="fs-filters-buttons">'+'<div id="fs-filters">'+'<a href="javascript:{}" id="fs-show-selected"><span>'+i.lang.buttonShowSelected+"</span></a>"+"</div>"+'<div id="fs-dialog-buttons">'+'<a href="javascript:{}" id="fs-submit-button" class="fs-button"><span>'+i.lang.buttonSubmit+"</span></a>"+'<a href="javascript:{}" id="fs-cancel-button" class="fs-button"><span>'+i.lang.buttonCancel+"</span></a>"+"</div>"+"</div>"+"</div>";c.html(t),b(),k(!0),S(),_(),n(e).resize(function(){k(!1)})},b=function(){n("#fs-user-list").append('<div id="fs-loading"></div>'),i.addUserGroups&&!i.facebookInvite?FB.api("/","POST",{batch:[{method:"GET",relative_url:"me/friends"},{method:"GET",relative_url:"me/groups"}]},function(e){w(e)}):FB.api("/me/friends",function(e){w(e)})},w=function(e){if(e.error)return FB.login(),!1;var t=[];if(i.addUserGroups&&!i.facebookInvite){var t=n.parseJSON(e[0].body
).data;n.merge(t,n.parseJSON(e[1].body).data)}else t=e.data;var r=i.maxFriendsCount!==null&&i.maxFriendsCount>0;if(i.showRandom===!0||r===!0)t=L(e.data);for(var s=0,o=0;s<t.length;s++){if(r&&i.maxFriendsCount<=o)break;n.inArray(parseInt(t[s].id,10),i.getStoredFriends)>=0&&(E(s,t,!0),o++)}for(var u=0;u<t.length;u++){if(r&&i.maxFriendsCount<=u+i.getStoredFriends.length)break;if(n.inArray(parseInt(t[u].id,10),i.excludeIds)>=0)continue;n.inArray(parseInt(t[u].id,10),i.getStoredFriends)<=-1&&E(u,t,!1)}n("#fs-loading").remove()},E=function(e,t,r){var i=n("<li/>"),s='<a class="fs-anchor" href="javascript://"><input class="fs-fullname" type="hidden" name="fullname[]" value="'+t[e].name.toLowerCase().replace(/\s/gi,"+")+'" />'+'<input class="fs-friends" type="checkbox" name="friend[]" value="fs-'+t[e].id+'" />'+'<img class="fs-thumb" src="/web/20150606094531/https://graph.facebook.com/'+t[e].id+'/picture" />'+'<span class="fs-name">'+N(t[e].name,15)+"</span>"+"</a>";i.append(s),n("#fs-user-list ul").append(i),r&&x(i)},S=function(){h.delegate("#fs-cancel-button","click.fs",function(){m()}),h.delegate("#fs-submit-button","click.fs",function(){g()}),n("#fs-dialog input").focus(function(){n(this).val()===n(this)[0].title&&n(this).val("")}).blur(function(){n(this).val()===""&&n(this).val(n(this)[0].title)}).blur(),n("#fs-dialog input").keyup(function(){C(n(this))}),h.delegate("#fs-reset","click.fs",function(){n("#fs-input-text").val(""),C(n("#fs-dialog input")),n("#fs-input-text").blur()}),h.delegate("#fs-user-list li","click.fs",function(){x(n(this))}),n("#fs-show-selected").click(function(){D(n(this))}),n(t).keyup(function(e){e.which===27&&i.enableEscapeButton===!0&&m()}),i.closeOverlayClick===!0&&(p.css({cursor:"pointer"}),p.bind("click.fs",m))},x=function(e){var t=e;if(t.hasClass("checked"))t.removeClass("checked"),t.find("input.fs-friends").attr("checked",!1),f--,f-1!==n("#fs-user-list li").length&&n("#fs-select-all").text(i.lang.buttonSelectAll);else{var r=A();if(r===!1)return t.find("input.fs-friends").attr("checked",!1),!1;f++,t.addClass("checked"),t.find("input.fs-friends").attr("checked",!0)}O()},T=function(){n("#fs-reset").undelegate("click.fs"),n("#fs-user-list li").undelegate("click.fs"),f=1,n("#fs-select-all").undelegate("click.fs")},N=function(e,t){var n=e.length;return n<=t?e:e.substr(0,t)+"..."},C=function(e){var t=n("#fs-dialog");l=n.trim(e.val());var r=l.toLowerCase().replace(/\s/gi,"+"),s=n("#fs-user-list .fs-fullname[value*="+r+"]"),o=n("#fs-user-list ul");o.children().hide(),n.each(s,function(){n(this).parents("li").show()});var u="";s.length>0&&l>""?(u=i.lang.summaryBoxResult.replace("{0}",'"'+e.val()+'"'),u=u.replace("{1}",s.length)):u=i.lang.summaryBoxNoResult.replace("{0}",'"'+e.val()+'"'),t.has("#fs-summary-box").length?t.has("#fs-result-text").length?n("#fs-result-text").text(u):n("#fs-summary-box").prepend('<span id="fs-result-text">'+u+"</span>"):n("#fs-filter-box").after('<div id="fs-summary-box"><span id="fs-result-text">'+u+"</span></div>"),l===""&&t.has("#fs-summary-box").length&&(f===1?n("#fs-summary-box").remove():n("#fs-result-text").remove())},k=function(r){u=n(e).width(),a=n(e).height();var s=n(t).height(),o=h.width(),f=h.height(),l=u/2-o/2,c=a/2-f/2;r===!0?p.css({"background-color":i.overlayColor,opacity:i.overlayOpacity,height:s}).fadeIn("fast",function(){h.css({left:l,top:c}).fadeIn()}):(h.stop().animate({left:l,top:c},200),p.css({height:s}))},L=function(e){for(var t,n,r=e.length;r;t=parseInt(Math.random()*r,10),n=e[--r],e[r]=e[t],e[t]=n);return e},A=function(){if(f>i.max&&i.max!==null){var e=i.lang.selectedLimitResult.replace("{0}",i.max);return n(".fs-limit").html('<span class="fs-limit fs-full">'+e+"</span>"),!1}},O=function(){if(f>1&&i.showSelectedCount===!0){var e=i.lang.selectedCountResult.replace("{0}",f-1);n("#fs-dialog").has("#fs-summary-box").length?n("#fs-dialog").has(".fs-limit.fs-count").length?n(".fs-limit").text(e):n("#fs-summary-box").append('<span class="fs-limit fs-count">'+e+"</span>"):n("#fs-filter-box").after('<div id="fs-summary-box"><span class="fs-limit fs-count">'+e+"</span></div>")}else l===""?n("#fs-summary-box").remove():n(".fs-limit").remove()},M=function(){n("#fs-user-list li").removeClass("checked"),n("#fs-user-list input.fs-friends").attr("checked",!1),f=1},_=function(){i.showButtonSelectAll===!0&&i.max===null&&(n("#fs-show-selected").before('<a href="javascript:{}" id="fs-select-all"><span>'+i.lang.buttonSelectAll+"</span></a> - "),h.delegate("#fs-select-all","click.fs",function(){f-1!==n("#fs-user-list li").length?(n("#fs-user-list li:hidden").show(),M(),n("#fs-user-list li").each(function(){x(n(this))}),n("#fs-select-all").text(i.lang.buttonDeselectAll),o===!0&&(o=!1,n("#fs-show-selected").text(i.lang.buttonShowSelected))):(M(),O(),n("#fs-select-all").text(i.lang.buttonSelectAll))}))},D=function(e){var t=n("#fs-user-list ul"),r=t.find("li"),s=t.find("li.checked");if(s.length!==0&&s.length!==r.length||o===!0)o===!0?(e.removeClass("active").text(i.lang.buttonShowSelected),t.children().show(),o=!1):(e.addClass("active").text(i.lang.buttonShowAll),t.children().hide(),n.each(s,function(){n(this).show()}),o=!0)},P={max:null,excludeIds:[],getStoredFriends:[],closeOverlayClick:!0,enableEscapeButton:!0,overlayOpacity:"0.3",overlayColor:"#000",closeOnSubmit:!1,showSelectedCount:!0,showButtonSelectAll:!0,addUserGroups:!1,color:"default",lang:{title:"Friend Selector",buttonSubmit:"Send",buttonCancel:"Cancel",buttonSelectAll:"Select All",buttonDeselectAll:"Deselect All",buttonShowSelected:"Show Selected",buttonShowAll:"Show All",summaryBoxResult:"{1} best results for {0}",summaryBoxNoResult:"No results for {0}",searchText:"Enter a friend's name",fbConnectError:"You must connect to Facebook to see this.",selectedCountResult:"You have choosen {0} people.",selectedLimitResult:"Limit is {0} people.",facebookInviteMessage:"Invite message"},maxFriendsCount:null,showRandom:!1,facebookInvite:!0,onStart:function(e){return null},onClose:function(e){return null},onSubmit
:function(e){return null}};n.fn.fSelector=function(e){return this.unbind("click.fs"),this.bind("click.fs",function(){i=e,v()}),this}}(window,document,jQuery),_favouriteAction=function(){$(".favourite-button").each(function(){var e=$(this).attr("_id");isFavourite(e)?$(this).addClass("favourite-added"):$(this).hasClass("favourite-added")&&$(this).removeClass("favourite-added")}),$(".favourite-button").tooltipster({content:'<div class="show-tooltip"><p class="inf">Add to favourite</p></div>'}),$(".favourite-added").tooltipster("destroy").tooltipster({content:'<div class="show-tooltip"><p class="inf">Added to favourite</p></div>'}),$(".favourite-button").on("click",function(e){var t=localStorage.getItem("login-type"),n=$(this);if(t==null||t=="")$(".overlay").fadeIn(function(){$("#sign-modal").fadeIn()});else{var r=!0;if($(this).hasClass("favourite-added")){var i={remove:JSON.stringify({type:$(this).attr("_type"),entity_id:$(this).attr("_id")})};r=!1}else var i={add:JSON.stringify({type:$(this).attr("_type"),entity_id:$(this).attr("_id")})};var s="/save-favourite";$.post(s,i,function(e){var t=JSON.parse(e);t.hasOwnProperty("error")||(r?(n.addClass("favourite-added"),$(".favourite-added").tooltipster("destroy").tooltipster({content:'<div class="show-tooltip"><p class="inf">Added to favourite</p></div>'})):(n.removeClass("favourite-added"),$(".favourite-button").tooltipster("destroy").tooltipster({content:'<div class="show-tooltip"><p class="inf">Add to favourite</p></div>'})),_favourite=t.favourite,localStorage.setItem("_favourite",JSON.stringify(_favourite)))})}e.stopPropagation()})};
